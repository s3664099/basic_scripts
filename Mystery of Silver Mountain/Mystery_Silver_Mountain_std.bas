10 LET EL=39:LET NO=88:LET NV=57:LET G=28
20 GOSUB 3380
30 GOSUB 4400
40 LET LL=0
50 GOSUB 3310
60 LET P$=X$(VAL(LEFT$(D$,1)))+" "+Y$(VAL(MID$(D$,2,1)))+" "
70 LET J$=R$+". "+"YOU ARE "+P$+RIGHT$(D$,LEN(D$)-2)+" ":GOSUB 4830
80 GOSUB 3330:LET J$=""
90 FOR I=1 TO G-1
100 READ O$
110 LET P$-Y$(VAL(LEFT(O$,1))):GOSUB 3350
120 IF F(I)=0 AND C(I)=R THEN LET J$=J$+" "+P$+" "+$O++","
130 NEXT I
140 IF R=29 AND F(48)=0 THEN LET J$=J$+" GRARGS FEASTING,"
150 IF R=29 AND F(48)=1 THEN LET J$=J$+" A SLEEPNG GRARG,"
160 IF R=12 OR R=22 THEN LET J$=J$+" A PONY,"
170 IF R=64 THEN LET J$=J$+" A HERMIT,"
180 IF R=18 AND E$(18)="N" THEN LET J$=$J+" AN OAK DOOR,"
190 IF R=59 AND F(68)=1 THEN LET J$=J$+" OGBAN (DEAD),"
200 IF J$<>"" THEN LET J$=", YOU CAN SEE"+J$
210 LET J$=J$+" AND YOU CAN GO "
220 GOSUB 4830:PRINT " ";
230 FOR I=1 TO LEN(E$(R)):PRINT MID$(E$(R),I,1);",";
240 NEXT I:PRINT:PRINT
250 LET R$="PARDON?":PRINT "========================================"
260 PRINT:PRINT:PRINT "WHAT WILL YOU DO NOW "
270 INPUT I$
280 IF I$="SAVE GAME" THEN GOTO 4630
290 LET V$="":LET T$="":LET VB=0:LET B=0
300 FOR I=1 TO LEN(I$)
310 IF MID$(I$,I,1)=" " AND V$="" THEN LET V$=LEFT$(I$,I-1)
320 IF MID$(I$,I+1,1)<>" " AND V$<>"" THEN LET T$=MID$(I$,I+1,LEN(I$)-1):LET I=LEN(I$)
330 NEXT I:IF T$="" THEN LET V$=I$
340 IF LEN(V$)<3 THEN LET V$=V$+"O":GOTO 340
350 IF V$="PLAY" THEN LET V$="BLO"
360 LET U$=LEFT$(V$,3)
370 FOR I=1 TO NV:IF MID$(B$,I*3-2,3)=U$ THEN LET VB=I:LET I=NV
380 NEXT I:LET F(36)=0
390 GOSUB 3330
400 FOR I=1 TO NO:READ O$:IF I<G THEN GOSUB 3350
410 IF T$=O$ THEN LET B=I:LET I=NO
420 NEXT I
430 IF B=0 AND F(36)=0 AND T$>"" THEN LET T$=T$+"S":LET F(36)=1:GOTO 390
440 IF VB=0 THEN LET VB=NV+1
450 IF T$="" THEN LET R$="I NEED TWO WORDS"
460 IF VB>NV THEN LET R$="TRY SOMETHING ELSE"
470 IF VB>NV AND B=0 THEN LET R$="YOU CANNOT "+I$
480 IF B>G OR B=0 THEN GOTO 510
490 IF VB=9 OR VB=9 OR VB=14 OR VB=17 OR VB=44 OR VB>54 THEN GOTO 510
500 IF VB<NV AND C(B)<>0 THEN LET R$="YOU DO NOT HAVE THE "+T$:GOTO 30
510 IF R=56 AND F(35)=0 AND VB<>37 AND VB<>53 THEN LET R$=X1$+" HAS GOT YOU!":GOTO 30
520 IF VB=44 OR VB=47 OR VB=19 OR VB=57 OR VB=49 THEN GOTO 540
530 IF R=48 AND F(63)=0 THEN LET R$-X9$:GOTO 30
540 LET H=VAL(STR$(R)+STR$(B))
550 ON INT((VB-1)/13)+1 GOTO 560,580,600,620,640
560 ON VB GOSUB 800,800,800,800,800,800,1220,1290,1290,1470,1470,1750,1890
570 GOTO 650
580 ON VB-13 GOSUB 1960,1980,2010,2050,2870,2120,2220,2310,2380,2420,2450,2470,2520
590 GOTO 650
600 ON VB-26 GOSUB 2550,2580,2610,2650,2670,2700,2720,2730,2830,2800,2870,2730,2920
610 GOTO 650
620 ON VB-39 GOSUB 2950,2990,3010,3050,3070,2310,2990,3070,3130,2120,3190,1470,3100
630 GOTO 650
640 ON VB-52 GOSUB 2870,3150,1290,1290,3170,3200
650 IF F(62)=1 THEN GOTO 730
660 IF R=41 THEN LET F(67)=F(67)+1:IF F(67)=10 THEN LET F(56)=1:LET R$="YOU SANK!"
670 IF R=56 AND F(35)=0 AND C(10)<>0 THEN LET R$=X1$+" GETS YOU!":LET F(56)=1
680 IF F(56)=0 THEN GOTO 30
690 GOSUB 4400:PRINT R$
700 PRINT "YOU HAVE FAILED IN YOUR QUEST!"
710 PRINT:PRINT "BUT YOU ARE GRANTED ANOTHER TRY"
720 GOSUB 3360:RUN
730 GOSUB 4400
740 PRINT "HOOOOORRRRRRAAAAAYYYYYY!"
750 PRINT
760 PRINT "YOU HAVE SUCCEEDED IN YOUR"
770 PRINT "QUEST AND BROUGHT PEACE TO"
780 PRINT "THE LAND"
790 STOP
800 LET D=VB
810 IF D=5 THEN LET D=1
820 IF D=6 THEN LET D=3
830 IF NOT ((R=75 AND D=2) OR (R=76 AND D=4)) OR F(64)=1 THEN GOTO 850
840 LET R$="B USPMM TUPQT ZPV DSPTTJOH":GOSUB 4260:RETURN
850 IF F(64)=1 THEN LET F(64)=0
860 IF F(51)=1 OR F(29)=1 THEN GOTO 900
870 IF F(55)=1 THEN LET F(56)=1:LET R$="GRARGS HAVE GOT YOU!":RETURN
880 IF R=29 AND F(48)=0 THEN LET R$="GRARGS WILL SEE YOU!":RETURN
890 IF R=73 OR R=42 OR R=9 OR R=10 THEN LET R$=X3$:LET F(55)=1:RETURN
900 IF C(8)=0 AND ((R=52 AND D=2) OR (R=31 AND D<>3)) THEN LET R$="THE BOAR IS TOO HEAVY":RETURN
910 IF C(8)<>0 AND ((R=52 AND D=4) OR (R=31 AND D=3)) THEN LET R$="YOU CANNOT SWIM":RETURN
920 IF R=52 AND C(8)=0 AND D=4 AND F(30)=0 THEN LET R$="NO POWER!":RETURN
930 IF R=41 AND D=3 AND F(31)=0 THEN LET R$="UIF CPBU JT TJOLJOH!":GOSUB 2460:RETURN
940 IF R=22 AND D=1 AND F(31)=0 THEN LET R$="OGBAN'S BOAR BLOCKS YOUR PATH":RETURN
950 IF ((R=3 AND D=2) OR (R=4 AND D=4)) AND F(45)=0 THEN LET R$=X5$:RETURN
960 IF R=35 AND C(13)<>R THEN LET R$="THE ICE IS BREAKING!":RETURN
970 IF R=5 AND (D=2 OR D=4) THEN GOSUB 4310
980 IF R=4 AND D=4 THEN LET R$="PASSAGE IS TOO STEEP":RETURN
990 IF R=7 AND D=2 AND F(46)=0 THEN LET R$="A HUGE HOUND BARS YOUR WAY":RETURN
1000 IF (R=38 OR R=37) AND F(50)=0 THEN LET R$="JU JT UPP EBSL":GOSUB 3260:RETURN
1010 IF R=49 AND D=2 AND F(54)=0 THEN LET R$="MYSTERIOUS FORCES HOLD YOU BACK":RETURN
1020 IF R=49 AND D=3 AND F(68)=0 THEN LET R$="YOU MET OGBAN!!":LET F(56)=1:RETURN
1030 IF R=38 AND F(65)=0 THEN LET R$="RATS NIBBLE YOUR ANKLES":RETURN
1040 IF R=58 AND (D=1 OR D=4) AND F(66)=0 THEN LET R$="YOU GET CAUGHT IN THE WEBS!":RETURN
1050 IF R=48 AND D=4 AND F(70)=0 THEN LET R$="THE DOOR DOES NOT OPEN":RETURN
1060 IF R=40 AND F(47)=1 THEN LET F(68)=1
1070 IF R=37 AND D=4 AND E$(37)="EW" THEN LET R=67:LET R$="THE PASSAGE WAS STEEP!":RETURN
1080 IF R=29 AND D=3 THEN LET F(48)=1:LET F(20)=0
1090 IF R=8 AND D=2 THEN LET F(46)=0
1100 LET OM=R:FOR I=1 TO LEN(E$(R))
1110 LET K$=MID$(E$(OM),I,1)
1120 IF (K$="N" OR K$="U") AND D=1 THEN LET R=R-10
1130 IF K$="E" AND D=2 THEN LET R=R+1
1140 IF (K$="S" OR K$="D") AND D=3 THEN LET R=R+10
1150 IF K$="W" AND D=4 THEN LET R=R-1
1160 NEXT I:LET R$="OK"
1170 IF R=OM THEN LET R$="YOU CANNOT GO THAT WAY"
1180 IF ((OM=75 AND D=2) OR (OM=76 AND D=4)) THEN LET R$="OK, YOU CROSSED"
1190 IF F(29)=1 THEN LET F(39)=F(39)+1
1200 IF F(39)>5 AND F(29)=1 THEN LET R$="CPPUT IBWF XPSO PVU":GOSUB 4260:LET F(29)=0:LET C(3)=81
1210 RETURN
1220 GOSUB 3330:LET R$="OK":LET F(49)=0
1230 PRINT "YOU HAVE ";
1240 FOR I=1 TO G:READ O$:GOSUB 3350:IF I=1 AND C(1)=0 AND F(44)=1 THEN LET O$="COIN"
1250 IF I=G AND C(5)=0 THEN GOTO 1270
1260 IF C(I)=0 THEN PRINT O$;",";:LET F(49)=1
1270 NEXT I:IF F(49)=0 THEN PRINT "NOTHING"
1280 PRINT:GOSUB 3360:RETURN
1290 IF H=6577 THEN LET R$="HOW?":RETURN
1300 IF H=4177 OR H=5177 THEN LET B=16:GOSUB 2380:RETURN
1310 IF B=38 THEN LET R$="TOO HEAVY!":RETURN
1320 IF B-4 AND F(43)=0 THEN LET R$="IT IS FIRMLY NAILED ON!":RETURN
1330 LET CO=0:FOR I=1 TO G-1: IF C(I)=0 THEN LET CO=CO+1
1340 NEXT I:IF CO>13 THEN LET R$="YOU CANNOT CARRY ANY MORE":RETURN
1350 IF B>G THEN LET R$="YOU CANNOT GET THE "+T$:RETURN
1360 IF B=0 THEN RETURN
1370 IF C(B)<>R THEN LET R$="IT IS NOT HERE!"
1380 IF F(B)=1 THEN LET R$="WHAT "+T$+"?"
1390 IF C(B)=0 THEN LET R$="YOU ALREADY HAVE IT"
1400 IF C(B)=R AND F(B)=0 THEN LET C(B)=0:LET R$="YOU HAVE THE "+T$
1410 IF B=28 THEN LET C(5)=81
1420 IF B=5 THEN LET C(2B)=0
1430 IF C(4)=0 AND C(12)=0 AND C(15)=0 THEN LET F(54)=1
1440 IF B=8 AND F(30)=1 THEN LET C(2)=0
1450 IF B=2 THEN LET F(30)=0
1460 RETURN
1470 LET R$="YOU SEE WHAT YOU MIGHT EXPECT!"
1480 IF B>0 THEN LET R$="NOTHING SPECIAL"
1490 IF B=46 OR B=88 THEN GOSUB 2550
1500 IF H=8076 THEN LET R$="IT IS EMPTY"
