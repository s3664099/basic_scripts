10 LET EL=39:LET NO=88:LET NV=57:LET G=28
20 GOSUB 3380
30 GOSUB 4400
40 LET LL=0
50 GOSUB 3310
60 LET P$=X$(VAL(LEFT$(D$,1)))+" "+Y$(VAL(MID$(D$,2,1)))+" "
70 LET J$=R$+". "+"YOU ARE "+P$+RIGHT$(D$,LEN(D$)-2)+" ":GOSUB 4830
80 GOSUB 3330:LET J$=""
90 FOR I=1 TO G-1
100 READ O$
110 LET P$-Y$(VAL(LEFT(O$,1))):GOSUB 3350
120 IF F(I)=0 AND C(I)=R THEN LET J$=J$+" "+P$+" "+$O++","
130 NEXT I
140 IF R=29 AND F(48)=0 THEN LET J$=J$+" GRARGS FEASTING,"
150 IF R=29 AND F(48)=1 THEN LET J$=J$+" A SLEEPNG GRARG,"
160 IF R=12 OR R=22 THEN LET J$=J$+" A PONY,"
170 IF R=64 THEN LET J$=J$+" A HERMIT,"
180 IF R=18 AND E$(18)="N" THEN LET J$=$J+" AN OAK DOOR,"
190 IF R=59 AND F(68)=1 THEN LET J$=J$+" OGBAN (DEAD),"
200 IF J$<>"" THEN LET J$=", YOU CAN SEE"+J$
210 LET J$=J$+" AND YOU CAN GO "
220 GOSUB 4830:PRINT " ";
230 FOR I=1 TO LEN(E$(R)):PRINT MID$(E$(R),I,1);",";
240 NEXT I:PRINT:PRINT
250 LET R$="PARDON?":PRINT "========================================"
260 PRINT:PRINT:PRINT "WHAT WILL YOU DO NOW "
270 INPUT I$
280 IF I$="SAVE GAME" THEN GOTO 4630
290 LET V$="":LET T$="":LET VB=0:LET B=0
300 FOR I=1 TO LEN(I$)
310 IF MID$(I$,I,1)=" " AND V$="" THEN LET V$=LEFT$(I$,I-1)
320 IF MID$(I$,I+1,1)<>" " AND V$<>"" THEN LET T$=MID$(I$,I+1,LEN(I$)-1):LET I=LEN(I$)
330 NEXT I:IF T$="" THEN LET V$=I$
340 IF LEN(V$)<3 THEN LET V$=V$+"O":GOTO 340
350 IF V$="PLAY" THEN LET V$="BLO"
360 LET U$=LEFT$(V$,3)
370 FOR I=1 TO NV:IF MID$(B$,I*3-2,3)=U$ THEN LET VB=I:LET I=NV
380 NEXT I:LET F(36)=0
390 GOSUB 3330
400 FOR I=1 TO NO:READ O$:IF I<G THEN GOSUB 3350
410 IF T$=O$ THEN LET B=I:LET I=NO
420 NEXT I
430 IF B=0 AND F(36)=0 AND T$>"" THEN LET T$=T$+"S":LET F(36)=1:GOTO 390
440 IF VB=0 THEN LET VB=NV+1
450 IF T$="" THEN LET R$="I NEED TWO WORDS"
460 IF VB>NV THEN LET R$="TRY SOMETHING ELSE"
470 IF VB>NV AND B=0 THEN LET R$="YOU CANNOT "+I$
480 IF B>G OR B=0 THEN GOTO 510
490 IF VB=9 OR VB=9 OR VB=14 OR VB=17 OR VB=44 OR VB>54 THEN GOTO 510
500 IF VB<NV AND C(B)<>0 THEN LET R$="YOU DO NOT HAVE THE "+T$:GOTO 30
