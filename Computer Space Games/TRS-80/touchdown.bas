20 CLS
30 CLEAR 200
31 B$=STRING$(25,131)
33 M1$=CHR$(194)+STRING$(2,176)
34 M2$=" "+STRING$(4,191)
35 M3$=CHR$(131)+CHR$(135)+STRING$(2,131)+CHR$(139)+CHR$(131)
40 GOSUB 250
50 GOSUB 300
60 C=1:GOSUB 390
70 A=1:B=F:GOSUB 460
80 A=2:B=ABS(V):GOSUB 460
90 A=3:B=H:GOSUB 460
100 A=4:B=T:GOSUB 460
110 GOSUB 530
120 V1=V-T/20+G:F=F-T/10
130 H1=H-(V+V1)/10
140 C=0:GOSUB 390
150 IF H1<0 THEN 200
160 H=H1:V=V1
170 IF H<=100 THEN 60
180 GOSUB 590
190 GOTO 220
200 H=0:C=1:GOSUB 390
210 GOSUB 660
220 END
250 H=100:F=100:T=0
260 V=INT(RND(0)*10+6)
270 G=INT(RND(0)*40+41)/100
280 RETURN
300 FOR X=80 TO 127
320 SET (X,47-INT(RND(0)*5))
330 NEXT
340 PRINT "GRAVITY=";G
350 PRINT @192,"FUEL:"
355 PRINT @384,"VEL:"
360 PRINT @576,"HEIGHT:"
365 PRINT @768,"THRUST:"
370 RETURN
390 Y=818-64*INT(H/8)
400 PRINT @Y,;:IF C=1 THEN PRINT M1$; ELSE PRINT CHR$(196)
410 PRINT @Y+64,;: IF C=1 THEN PRINT M2$; ELSE PRINT CHR$(198)
420 PRINT @Y+128,;: IF C=1 THEN PRINT M3$; ELSE PRINT CHR$(198)
440 RETURN
460 Y=(A*3+1)*64
470 PRINT @Y,CHR$(217);
480 PRINT @Y,LEFT$(B$,B/4);
510 RETURN
530 I$=INKEY$
540 IF I$="A" THEN T=T+4:IF T>100 THEN T=100
550 IF I$="D" THEN T=T-4: IF T<0 THEN T=0
560 IF T>F THEN T=F
570 RETURN
590 CLS
600 FOR I=1 TO 20
610 PRINT @INT(RND(0)*1023),"*"
620 NEXT
630 PRINT @470,"LOST IN SPACE!!"
640 RETURN
650 CLS
660 PRINT "LANDED AT VEL "; INT((V+V1)*5)/10
670 IF (V+V1)<8 THEN PRINT "SAFELY" ELSE PRINT "ALL DEAD"
680 RETURN
