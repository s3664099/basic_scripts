20 MODE 5
30 *FX 12,1
40 PROCSETVAR
50 PROCDISPLAY
60 PROCMODULE (H,3)
70 PROCBAR (1,F,3+3*(F<25))
80 PROCBAR (2,ABSV,3+(V<0))
90 PROCBAR (3,H,3+2*(H<25))
100 PROCBAR (4,T,3)
110 PROCTHRUST
120 V1=V-T/20+G: F=F-T/10
130 H1=H-(V+V1)/10
140 PROCMODULE(H,0)
150 IF H1<0 THEN 200
160 H=H1:V=V1
170 IF H<=100 THEN 60
180 PROCLOST
190 GOTO 220
200 PROCMODULE(0,2)
210 PROCLANDED
220 *FX 12
230 END
240 DEF PROCSETVAR
250 H=100:F=100:T=0
260 V=5+RND(10)
270 G=(RND(40)+40)/100
280 ENDPROC
290 DEF PROCDISPLAY
300 MOVE 800,30
310 FOR X=800 TO 1280 STEP 16
320 DRAW X,10+RND(40)
330 NEXT
340 PRINT "GRAVITY=";G
350 PRINT ''''"FUEL:"''''''"VEL:"
360 PRINT '''''"HEIGHT:"''''''"THRUST:"''
370 ENDPROC
380 DEF PROCMODULE(H,C)
390 GCOL 0,C
400 Y=H*8.5+150
410 MOVE 1040,Y : PLOT 1,-40,-40
420 PLOT 1,-8,-60 : PLOT 1,96,0
430 PLOT 1,-8,60 : PLOT 1,-40,40
440 ENDPROC
450 DEF PROCBAR(N,V,C)
460 Y=1000-192*N
470 GCOL 0,C
480 MOVE 0,Y : MOVE 0,Y-16
490 PLOT 85,V*4,Y : PLOT 85,V*4,Y-16
500 PLOT 87,400,Y : PLOT 87,400,Y-16
510 ENDPROC
520 DEF PROCTHRUST
530 *FX 15,1
540 IF INKEY(-194) THEN T=T+4 : IF T>100 THEN T=100
550 IF INKEY(-179) THEN T=T+4 : IF T<0 THEN T=0
560 IF T>F THEN T=F
570 ENDPROC
580 DEF PROCLOST
590 CLS
600 FOR I=1 TO 20
610 VDU 31,RND(19),RND(31),42
620 NEXT
630 PRINT TAB(4,16)"LOST IN SPACE!!"
640 ENDPROC
650 DEF PROCLANDED
660 VDU 28,0,31,11,0,12
670 PRINT '"LANDED"
680 PRINT '"AT VEL ";INT((V+V1)*5)/10
690 IF (V+V1)<8 THEN PRINT '"SAFELY" ELSE PRINT '"ALL DEAD"
700 ENDPROC

